\documentclass[11pt,twoside,a4paper]{book}  
% definice dokumentu
\usepackage[czech, english]{babel}
\usepackage[T1]{fontenc} 				% pouzije EC fonty 
\usepackage[utf8]{inputenc} 			% utf8 kódování vstupu 
\usepackage[square, numbers]{natbib}	% sazba pouzite literatury
\usepackage{indentfirst} 				% 1. odstavec jako v cestine, pro práci v aj možno zakomentovat
\usepackage{fancyhdr}					% tisk hlaviček a patiček stránek
\usepackage{nomencl} 					% umožňuje snadno definovat zkratky a jejich seznam

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% informace o práci
\newcommand\WorkTitle{Nástroj pro tvorbu a sdílení HTML5 prezentací na webu}		% název
\newcommand\FirstandFamilyName{Radek Ježdík}															% autor
\newcommand\Supervisor{Ing. Ondřej Macek}															% vedoucí

\newcommand\TypeOfWork{Bakalářská práce}	% typ práce [Diplomová práce | Bakalářská práce | Bachelor's Project | Master's Thesis ]	

% Nastavte následují podle vašeho oboru a programu (pomoc hledejte na http://www.fel.cvut.cz/cz/education/bk/prehled.html)								
\newcommand\StudProgram{Softwarové technologie a management, Bakalářský}	% program
\newcommand\StudBranch{Softwarové inženýrství}           					% obor

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% minimální importy
\usepackage{graphicx}					% pro vkládání obrázků
\usepackage{k336_thesis_macros} 		% specialni makra pro formatovani DP a BP
\usepackage[
pdftitle={\WorkTitle},				% nastaví v informacích o pdf název
pdfauthor={\FirstandFamilyName},	% nastaví v informacích o pdf autora
colorlinks=true,					% před tiskem doporučujeme nastavit na false, aby odkazy a url nebyly šedé při ČB tisku
breaklinks=true,
urlcolor=red,
citecolor=blue,
linkcolor=blue,
unicode=true,
]
{hyperref}								% pro zobrazování "prokliknutelných" linků 

% rozšiřující importy
\usepackage{listings} 			%slouží pro tisk zdrojových kódů se syntax higlighting
\usepackage{algorithmicx} 		%slouží pro zápis algoritmů
\usepackage{algpseudocode} 		%slouží pro výpis pseudokódu
\usepackage{enumitem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% příkazy šablony
\makenomenclature								% při překladu zajistí vytvoření pracovního souboru se seznamem zkratek

\let\oldUrl\url									% url adresy budou zobrazeny: <url> 
\renewcommand\url[1]{<\texttt{\oldUrl{#1}}>}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% vaše vlastní příkazy
\newcommand*{\nomExpl}[2]{#2 (#1)\nomenclature{#1}{#2}} 	% usnadňuje zápis zkratek : Slova ke Zkrácení (SZ)
\newcommand*{\nom}[2]{#1 \nomenclature{#1}{#2}} 			% usnadňuje zápis zkratek : SZ


\usepackage{nameref}

\usepackage{hvfloat}

\usepackage{float}
\restylefloat{table}

\lstset{
	literate=%
		{á}{{\'a}}1
		{í}{{\'i}}1
		{é}{{\'e}}1
		{ý}{{\'y}}1
		{ú}{{\'u}}1
		{ó}{{\'o}}1
		{ě}{{\v{e}}}1
		{š}{{\v{s}}}1
		{č}{{\v{c}}}1
		{ř}{{\v{r}}}1
		{ž}{{\v{z}}}1
		{ď}{{\v{d}}}1
		{ť}{{\v{t}}}1
		{ň}{{\v{n}}}1
		{ů}{{\r{u}}}1
		{Á}{{\'A}}1
		{Í}{{\'I}}1
		{É}{{\'E}}1
		{Ý}{{\'Y}}1
		{Ú}{{\'U}}1
		{Ó}{{\'O}}1
		{Ě}{{\v{E}}}1
		{Š}{{\v{S}}}1
		{Č}{{\v{C}}}1
		{Ř}{{\v{R}}}1
		{Ž}{{\v{Z}}}1
		{Ď}{{\v{D}}}1
		{Ť}{{\v{T}}}1
		{Ň}{{\v{N}}}1
		{Ů}{{\r{U}}}1
}
\lstset{basicstyle=\ttfamily}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% vlastní dokument
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
	
	%%%%%%%%%%%%%%%%%%%%%%%%%% 
	% nastavení jazyka, kterým je práce psána
	\selectlanguage{czech}	% podle jazyka práce nastavte na [czech | english]
	\translate				% nastaví české nebo anglické popisy (např. katedra -> department); viz k336_thesis_macros

	%%%%%%%%%%%%%%%%%%%%%%%%%%    
	% Poznamky ke kompletaci prace
	% Nasledujici pasaz uzavrenou v {} ve sve praci samozrejme 
	% zakomentujte nebo odstrante. 
	% Ve vysledne svazane praci bude nahrazena skutecnym 
	% oficialnim zadanim vasi prace.
%	{
%	\pagenumbering{roman} \cleardoublepage \thispagestyle{empty}
%	\chapter*{Zadání projektu}
%	Vytvořte nástroj pro tvorbu a sdílení HTML5 prezentací na webu. Webový backend umožní  tvorbu a editaci slidů a jejich %sdílení. Pro prezentaci použijte vhodnou JavaScriptovou knihovnu, kterou rozšiřte o možnost testování čtenářů prezentace. %Další požadavky na software sesbírejte na základě vytvořeného prototypu.\\\\
	
%	\noindent Očekávaný výstup aplikace:
%	\begin{enumerate}
%		\item Analýza, návrh a implementace webové aplikace pro tvorbu, editaci a sdílení prezentací
%		\item Rozšíření prezentační JS knihovny
%		\item Nasazení a otestování aplikace
%	\end{enumerate}
%	\newpage
%	}

	%%%%%%%%%%%%%%%%%%%%%%%%%%    
	% Titulni stranka / Title page 
	\coverpagestarts

	%%%%%%%%%%%%%%%%%%%%%%%%%%%    
	% Poděkovani / Acknowledgements 

	\acknowledgements
	\noindent
	Rád bych zde poděkoval své rodině, která mě po celou dobu studia podporovala. Dále bych chtěl poděkovat Ing. Ondřeji Mackovi, vedoucímu této bakalářské práce, za odlehčený přístup a komunikaci v přátelském duchu.


	%%%%%%%%%%%%%%%%%%%%%%%%%%%   
	% Prohlášení / Declaration 

	\declaration{V~Praze dne 24.\,5.\,2013}


	%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
	% Abstrakt / Abstract 
 
	\abstractpage

	Translation of Czech abstract into English.

	% Prace v cestine musi krome abstraktu v anglictine obsahovat i
	% abstrakt v cestine.
	\vglue60mm

	\noindent{\Huge \textbf{Abstrakt}}
	\vskip 2.75\baselineskip

	\noindent
	Předmětem této práce je návrh a vývoj webového nástroje pro tvorbu a sdílení HTML prezentací. Cílem je vytvořit portál, který umožní tvorbu webových prezentací za účelem jejich prohlížení a sdílení. Obsahem této práce je analýza, návrh, implementace a testování systému.

	%%%%%%%%%%%%%%%%%%%%%%%%%%    
	% obsahy a seznamy
	\tableofcontents		% Obsah / Table of Contents 

	% pokud v práci nejsou obrázky nebo tabulky - odstraňte jejich seznam
	\listoffigures			% Obsah / Table of Contents 
	% \listoftables			% Seznam tabulek / List of Tables

	%%%%%%%%%%%%%%%%%%%%%%%%%% 
	% začátek textu  
	\mainbodystarts



\chapter{Úvod}
Tento projekt má za cíl vytvořit webový portál, který uživatelům umožní nejen snadné sdílení vlastních prezentací, ale také jejich tvorbu. Jediným nástrojem tak uživatel prezentaci vytvoří a poté ji v rámci portálu či jiných komunikačních kanálů, jako jsou sociální sítě, může šířit dál mezi lidi. Prezentace by se měly zaměřovat na podání informací a na případné testování uživatelů z nově nabytých vědomostí. Portál tak bude sloužit jak přednášejícím, tak posluchačům či žákům.

\section{Cíle}
Sdílení a tvorba prezentací online není originální myšlenka a v současné době existuje řada známých i méně známých portálů, které v této oblasti dosáhly dobrých výsledků. Proto jsem se rozhodl projekt zaměřit zejména na použití ve vzdělávacích institucích či školách a nebo na odborných konferencích, kde je důležité v prezentacích podat důležité informace, nejen tedy hlavní body.

Stejně tak je důležité, aby tyto prezentace byly použitelné i mimo přednášku, tedy aby podaly významné informace i bez mluveného slova, například pro domácí přípravu nebo vlastní rozvoj. Pro zjednodušení tohoto cíle proto nástroj bude poskytovat několik prostředků jako je zvýraznění kódu programovacích jazyků či zobrazení matematických vzorců pomocí syntaxe \LaTeX. Navíc bude možné do prezentací vkládat kontrolní otázky, na které budou moci uživatelé odpovídat a systém je opraví, případně lze přidat i odkazy na snímek, ve kterém se o otázce mluví.

\section{Příležitosti}
Od práce na tomto projektu si slibuji větší porozumění technologiím HTML5 a JavaScriptu. Zajímavou příležitostí je tedy vyzkoušení si tvorby webových stránek, které nejsou jen dalším typickým informačním systémem. V tomto projektu lze najít spoustu problémů a nových a zajímavých technologií, na kterých si vyzkouším vývoj nových klientských aplikací.






\chapter{Analýza}
V této kapitole je představena vize vyvíjeného systému. Dále je čtenář uveden do problematiky \nom{HTML}{HyperText Markup Language} prezentací a jsou porovnávány vybrané knihovny, které zajišťují funkčnost těchto prezentací. Nakonec jsou uvedeny podobné již existující systémy.

\section{Popis problému, cíle}
Cílem projektu je vytvořit webový nástroj pro tvorbu, úpravu a sdílení prezentací založených na technologii HTML5.

V současné době se většina aplikací, nástrojů a služeb přesouvá na internet, kde se mimo jiné klade důraz na sdílení mezi uživateli. Prezentace nejsou výjimkou a na trhu lze najít již několik zavedených služeb, které se tvorbou a sdílením prezentací zabývají (více na str. \pageref{chap:existujiciSystemy}). S příchodem HTML5 a CSS3\footnote{V době psaní této práce bylo HTML5 ve stádiu návrhu organizací W3C.~\cite{html5-2014}} se objevily knihovny, které využívají těchto nových technologií pro zobrazení webových prezentací přímo v prohlížeči bez doplňků třetích stran.

Tento webový portál tak bude využívat těchto nových technologií a knihoven pro poskytnutí možnosti tvorby vlastních prezentací na webu, jejich prohlížení a také sdílení dalším uživatelům.


\section{User stories}\label{chap:userstory}
Následující odstavce uvádí uživatelské role, které se při používání systému objevují. Každá role pak má nějaká práva či možnosti využití systému. Popis je zapsán pomocí techniky zvané user story používané v agilních metodikách vývoje software. \\\\

\noindent \textbf{Nepřihlášený uživatel} bude mít možnost:
\begin{enumerate}
	\item \textbf{prohlížet veřejně dostupné prezentace}, k~tomu použije 
		\begin{enumerate}[label*=\arabic*.]
			\item vyhledávací formulář na webu.
			\item adresu URL na stránku s prezentací, kterou dostane jiným komunikačním kanálem.
		\end{enumerate}
	\item \textbf{vyhledat prezentace} vyhledávacím formulářem podle názvu nebo autora, aby mohl
		\begin{enumerate}[label*=\arabic*.]
			\item zhlédnout hledanou prezentaci.
			\item číst komentáře pod prezentací.
			\item zobrazit prezentace hledaného uživatele.
		\end{enumerate}
	\item \textbf{přihlásit se} do systému pomocí přihlašovacího formuláře, aby získal oprávnění přihlášeného uživatele (viz níže).
	\item \textbf{registrovat se} do systému pomocí registračního formuláře, aby se mohl přihlásit.
\end{enumerate}


\noindent \textbf{Přihlášený uživatel} bude mít možnost:
\begin{enumerate}
	\item \textbf{vytvářet} prezentace pomocí editoru prezentací.
	\item \textbf{posílat komentáře} k~prezentacím, ke kterým má přístup, pomocí formuláře pod prezentací.
	\item \textbf{prohlížet veřejné a jemu sdílené} prezentace.
	\item \textbf{vyhledat prezentace} vyhledávacím formulářem podle názvu nebo autora, aby kromě toho co může nepřihlášený uživatel:
		\begin{enumerate}[label*=\arabic*.]
		\item \textbf{sledovat nebo zrušit sledování} hledaného uživatele.
		\end{enumerate}
	\item \textbf{vidět seznam jemu sdílených prezentací}.
	\item \textbf{vidět seznam veřejných prezentací} uživatelů, které \textbf{sleduje}.
	\item \textbf{změnit své heslo}.
	\item \textbf{odhlásit se}.
\end{enumerate}


\noindent \textbf{Autor prezentace} bude mít možnost:
\begin{enumerate}
	\item \textbf{upravit prezentaci} v~editoru, aby ji o něco doplnil nebo ji opravil.
	\item \textbf{smazat prezentaci}.
	\item \textbf{smazat jakýkoliv komentář} k~vlastní prezentaci.
	\item \textbf{sdílet prezentaci} ostatním uživatelům portálu.
\end{enumerate}


\noindent \textbf{Autor komentáře} bude mít možnost:
\begin{enumerate}
	\item smazat svůj komentář.
\end{enumerate}


\section{Nefunkční požadavky}
\begin{enumerate}
	\item Systém bude přístupný přes webové rozhraní.
	\item Systém bude pro uživatele nezávislý na platformě.
	\item Systém bude využívat technologii HTML5.
	\item Pro prezentace bude systém využívat JavaScriptovou knihovnu.
\end{enumerate}



\section{HTML prezentace}
Prezentace založené na HTML jsou z pohledu kódu běžná webová HTML stránka. K~popisu obsahu snímků se používají sémantické značky běžně používané v HTML (např. nadpisy, odstavce, obrázky). Pro úpravu grafické podoby se pak používá \nom{CSS}{Cascading Style Sheets}. S použitím technologie HTML5 lze pak využít i nových možností CSS3, například animace přechodů. K~oživení takovéto stránky a~vytvoření dojmu prezentace včetně interakce s uživatelem pro přechod mezi snímky se používá JavaScript. To vše a další vylepšující funkce jsou zajištěny mnoha existujícími JavaScriptovými knihovnami.

Každá z existujících knihoven používá trochu jiná pravidla pro konfiguraci prezentace či jednotlivých snímků. Následující výpis ukazuje zdrojový kód jednoduché HTML prezentace při použití knihovny deck.js.

\begin{lstlisting}[caption=Ukázka zdrojového kódu HTML prezentace (deck.js)]
<body class="deck-container">
  <section class="slide">
    <h1>Moje prezentace</h1>
  </section>

  <section class="slide">
    <h2>Nadpis snímku</h2>
    <p>Osnova:</p>
    <ul>
      <li>Bod 1</li>
      <li>Bod 2</li>
      <li>Bod 3</li>
    </ul>
  </section>
</body>
\end{lstlisting}

Zobrazení právě jednoho snímku, přecházení mezi snímky a držení stavu prezentace pak obstarává knihovna samotná. Na autorovi prezentace je jen napsat obsah snímků a dodržet konvence požadované knihovnou.


\section{Výběr JavaScriptové knihovny}
Knihoven pro zobrazení prezentací založených na technologii (X)HTML byla vytvořena celá řada (viz~\cite{htmlslideshowweb}). Většina z nich je ovšem už zastaralá, nefunkční nebo neodpovídající požadovaným kvalitám, například použitelností, uživatelské či implementační, nebo zastaralým vzhledem. Následující seznam uvádí několik zdařilých knihoven, které se objevily po uvedení podpory HTML5 v~prohlížečích.

\begin{itemize}
	\item reveal.js
	\item impress.js
	\item Google I/O HTML5 slide template
	\item deck.js
\end{itemize}

Následující odstavce stručně popisují každou z uvedených knihoven. Nakonec je uvedeno jaká knihovna byla vybrána pro tento projekt a proč.

\subsection{Reveal.js} \label{chap:revealjs}
Reveal.js\footnote{\url{https://github.com/hakimel/reveal.js/}} podporuje kromě posunu snímků horizontálně také vnořené snímky, na které se lze dostat posunem dolů. Má několik zajímavých rozšíření, např. podpora syntaxe Markdown pro psaní obsahu a barevné zvýraznění kódu programovacích jazyků pomocí knihovny highlight.js. V novém okně prohlížeče pak poskytuje zobrazení prezentace pro přednášejícího, který ukazuje aktuální a následující snímek včetně poznámek.

\subsection{Impress.js}
Impress.js\footnote{\url{https://github.com/bartaz/impress.js/}} se více zaměřuje na vizuální jedinečnost prezentace. Dosahuje toho složitými transformacemi přechodů mezi snímky. Ty jsou rozloženy v~prostoru, a to nejen ve 2D ale i ve 3D, o různých velikostech a při přechodu mezi snímky se pohled působivě otáčí a přesouvá.

Nevýhoda této knihovny je právě v tomto jednoúčelově pojatému zobrazení. Pro tento projekt je tak knihovna až moc složitá, hlavně kvůli určení pozic snímků a transformací, a pro informativní prezentace se příliš nehodí - přechody mezi snímky spíše vyrušují.

\subsection{Google I/O HTML5 slide template}
HTML5 šablonu od Googlu\footnote{\url{https://code.google.com/p/io-2012-slides/}} používají při svých prezentacích vývojáři na konferencích Google I/O. Knihovna je proto v dobré kvalitě a velmi dobře uzpůsobená pro přednášející. Obsahuje tzv. prezentační mód podobný tomu v reveal.js. Poskytuje také zvýraznění kódu programovacích jazyků a to včetně možnosti zdůraznit jen určitou část kódu, které se přednášející chce věnovat podrobněji.

Knihovna ovšem nenabízí žádnou dokumentaci a tak snižuje možnost na další rozšíření. Dále má prezentace pevnou velikost a tak na menších displejích či oknech jsou snímky oříznuté. Nevýhodou je také o něco složitější konfigurace.

\subsection{Deck.js}
Knihovna deck.js\footnote{\url{https://github.com/imakewebthings/deck.js}} je v základu o něco jednodušší než ostatní knihovny výše. Je napsaná s pomocí knihovny jQuery~\cite{jQuery}, je velmi dobře zdokumentovaná a rozšiřitelná. Existuje pro ni řada pluginů, například již zmíněný prezentační mód či podpora Markdown syntaxe pro popis snímků. 

\subsection{Zhodnocení}
Pro účely tohoto projektu byla vybrána knihovna deck.js, která je sice o něco jednodušší, ale líbí se mi více celkový vzhled a jednoduchost a to, že je postavena na jQuery. Případně lze také využít existujících rozšíření nebo vytvořit vlastní. Knihovna reveal.js ovšem urazila během práce na tomto projektu velký kus cesty a v současné době je asi nejvíce rozšířenou a používanou knihovnou pro HTML prezentace. O knihovně již byla také napsána výuková kniha~\cite{howtobook}.


\section{Webový portál}
Pro uživatele má portál sloužit jako prostředník pro sdílení prezentací – ať už v~rámci portálu mezi jeho uživateli nebo
posíláním URL odkazů na prezentace v~emailech, příspěvcích na sociálních sítích jako Facebook nebo Twitter a podobných. V principu se tak bude podobat portálům jako YouTube, SlideShare nebo GitHub, které se zaměřují na vystavení vlastní tvorby (videí, prezentací, kódu) a její sdílení.

Sdílení prostřednictvím webového portálu je dvojího typu. Uživatelé mohou sledovat jiné uživatele a o aktivitách těchto sledovaných uživatelů, například publikace nové prezentace, bude snadněji upozorněn. Druhý typ je pak sdílení opačným směrem, od autora prezentace uživatelům portálu. Uživatele si autor vybere podle uživatelského jména či e-mailu.

Důležitá je také zpětná vazba od uživatelů prohlížející si prezentace. Řešením je možnost uživatelů přidávat komentáře k jednotlivým prezentacím.

\section{Editor}
Důležitou částí tohoto projektu je editor pro úpravy prezentace. Protože obsah prezentace je tvořen pomocí HTML, nabízí se
několik možností, jak editaci pojmout:

\begin{enumerate}
	\item psaním samotného HTML kódu.
	\item využitím editoru typu \nom{WYSIWYG}{What You See Is What You Get}.
	\item využitím jednoduchého textového značkovacího jazyka (lightweight markup language).
\end{enumerate}

Psaní samotného HTML kódu bylo vyloučeno bez většího váhání. HTML není nijak úsporný značkovací jazyk a pro uživatele, kteří neznají HTML, by byl překážkou. Na druhou stranu ale poskytuje největší možnou kontrolu nad podobou a funkčností prezentace. Kdyby ovšem editor měl být založen pouze na psaní HTML kódu, nebyl by vůbec potřeba - pro většinu uživatelů by pak bylo výhodnější použít nástroje, na které jsou zvyklí, a pak pouze nahrát hotovou prezentaci na web.

Editor WYSIWYG je koncept dobře známý z desktopových aplikací. Jedná se o přímou úpravu obsahu a uživatel nepřichází do styku se zdrojovým kódem. Jeho největší výhodou je pak jednoduchost pro uživatele, kteří výsledek svých úprav vidí okamžitě. Ve webovém prostředí se používá pro jednoduché vytváření stránek, například v CMS systémech. Nevýhodou je, že neexistuje standard, který by dodržovaly všechny prohlížeče. Poskytuje také menší kontrolu nad výsledným kódem. 

Vybrána byla nakonec poslední možnost - jednoduchý textový značkovací jazyk, jímž se bude popisovat obsah snímku. Zdrojový text se následně převádí do kódu HTML. Více je popsáno v~kapitole \ref{chap:realizace} \nameref{chap:realizace} na str. \pageref{chap:realizace}.

\section{Prohlížení prezentace}
Zajímavou vlastností, která se liší od ostatních webových služeb pro prohlížení prezentací, byla možnost poskytnout větší interaktivitu s uživatelem. Protože je prezentace běžná HTML stránka, lze využít možností webových technologií pro vytvoření nových vlastností prezentace.

Jednou z nich je možnost odpovídat na otázky a kontrolovat správné odpovědi přímo v prezentaci. Uživatelé si pak mohou vyzkoušet, co se z prezentace naučili. Navíc je možné zobrazit doplňkový text při správné či špatné odpovědi. Ten pak může obsahovat nejen vysvětlení správné odpovědi, ale třeba i odkaz na snímek týkající se dané otázky.


\section{Rešerše existujících řešení} \label{chap:existujiciSystemy}
Během analýzy byly také vyhledány a vyzkoušeny již existující služby, jejichž funkčnost se nejvíce podobá zadání tohoto projektu. Následující odstavce popisují jejich funkci a rozdíly.


\subsection{SlideShare}
SlideShare\footnote{\url{http://www.slideshare.net}} je na internetu velmi známý webový portál pro sdílení prezentací. Obsahuje podobné mechanismy sdílení a zpětné vazby a umožňuje prezentace umisťovat na jiné stránky (tzv. embedded prezentace). Prezentace jsou ovšem velmi statické – bez animací a bez větší interaktivity s~uživatelem. Některé prezentace jsou jen obrázkové, nejde tedy označit text ani následovat odkaz. Největší nevýhodou je, že prezentace nelze na portálu přímo tvořit, lze je pouze nahrávat ve formátech PDF, PPT a dalších z~lokálního úložiště. Jakákoliv změna v~prezentaci se tak musí nahrát znovu.

\subsection{Prezi}
Prezi\footnote{\url{http://www.prezi.com}} funguje na podobném principu jako SlideShare, ale zaměřuje se daleko více na grafickou stránku a zakládá si na kreativitě uživatelů a vyjádření jejich idejí pomocí celkového vzhledu prezentace. Prezentace se značně liší od běžných prezentací, které známe například z~Microsoft PowerPoint. Jejich použití se hodí hlavně pro vyjádření nějaké myšlenky či vize, méně se hodí pro podání důležitých informací. Velmi dobrou vlastností je živé sdílení, tj. procházení prezentace se synchronizuje mezi uživateli. Pro zobrazení prezentace používá technologii Flash.

\subsection{Rvl.io}
Rvl.io\footnote{\url{http://www.rvl.io}} je služba od autora knihovny reveal.js popsané na str. \pageref{chap:revealjs}, kterou také používá pro zobrazení prezentací. Služba umožňuje sdílení i tvorbu prezentací přímo na webu. Sdílení je založeno na předávání adresy URL, poskytuje ale také vkládání prezentace do jiných stránek, podobně jako SlideShare. Pro úpravu prezentací využívá WYSIWYG editor, který ale poskytuje jen nezbytné minimum funkcí. Tento portál je velmi mladý a uveden byl po měsíci od započetí práce na tomto projektu. Služba byla v~době psaní této práce stále ve fázi beta testování.

\subsection{Shrnutí}
Rvl.io jako jediný z vybraných systémů používá pro zobrazení prezentací HTML. Také poskytuje možnost tvorby prezentace a její sdílení, nejvíce se tak podobá zadání tohoto projektu. Neposkytuje ovšem žádnou přidanou hodnotu, která by se dala ve webovém prostředí využít. SlideShare staví do popředí hlavně sdílení prezentací a má proto bohaté mechanismy. Do projektu se budu snažit převzít to dobré z obou dvou, např. sledování uživatelů. Prezi naopak, i když je to velmi vydařená a propracovaná služba, míří zcela na jinou cílovou skupinu. 


\section{Doménový model}
Z user stories vychází doménový model, který ukazuje celý systém jako provázané entity vyskytující se v systému. Celý model je přehledně zobrazen na obrázku \ref{fig:domainModel} v jazyce UML. Popis jednotlivých entit a jejich vlastností následuje v odstavcích níže.

\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/domain.png}
		\caption{Diagram doménového modelu}
		\label{fig:domainModel}
	\end{center}
\end{figure}

\subsection{Uživatel}
Uživatel představuje registrovaného uživatele systému. Registrovaný a přihlášený uživatel má výhody oproti nepřihlášenému (více na str. \pageref{chap:userstory}).

Pro úspěšnou registraci nového uživatele do systému musí nepřihlášený uživatel zadat:

\begin{itemize}
	\item \textbf{uživatelské jméno}, pod kterým se bude prezentovat a přihlašovat. Stejné uživatelské jméno musí být v systému registrováno jenom jednou.
	\item \textbf{e-mail}, který musí být v systému jedinečný.
	\item \textbf{heslo}, minimální délka 4 znaky.
\end{itemize}

Uživatelé se mohou navzájem tzv. sledovat. Uživatel je tak snadněji upozorněn na nové prezentace od sledovaných uživatelů.

\subsection{Prezentace}
Tato entita představuje jednu prezentaci, kterou uživatel pomocí systému vytvořil, tedy je jejím autorem. Má tyto povinné
vlastnosti:

\begin{itemize}
	\item \textbf{název}, pod kterým se daná prezentace bude zobrazovat ve výpisech.
	\item \textbf{slug} - zjednodušený název (malá písmena anglické abecedy, čísla a pomlčky), pod kterým bude prezentace dostupná přes adresu URL. Pro daného autora je jedinečný, tj. kombinace uživatelského jména a slugu je unikátní.
	\item \textbf{obsah}, jenž představuje složitější objekt textů jednotlivých snímků a různých nastavení prezentace.
\end{itemize}

Při vytvoření je prezentace ve stavu nepublikováno. Stav se změní na publikováno při publikaci prezentace v editoru. Pak je prezentace viditelná ostatním uživatelům v systému.

Prezentace může být sdílena konkrétním uživatelům portálu.


\subsection{Koncept}
Koncept je obsah prezentace (popis snímků, nastavení), který nebyl zatím publikován. Je viditelný pouze v editoru pro autora prezentace. Při publikaci změn prezentace se obsah konceptu překopíruje do obsahu vlastní entity prezentace, změny jsou pak viditelné i dalšími uživateli.


\subsection{Komentář}
Komentář je uživatelem napsaná poznámka k dané prezentaci. Komentář může vkládat každý přihlášený uživatel. Povinné
vlastnostmi jsou:

\begin{itemize}
	\item \textbf{text komentáře} – obsah zprávy
	\item \textbf{datum a čas}, kdy byl komentář vložen
\end{itemize}

Komentář se váže k~jedné prezentaci a jednomu uživateli (autorovi komentáře).



\chapter{Návrh}
V následujícím textu bude čtenář seznámen s detailním návrhem systému, použitými technologiemi a knihovnami.

\section{Serverová část}
Webový back-end jsem se rozhodl napsat v~programovacím jazyce PHP s~použitím českého webového aplikačního frameworku Nette~\cite{nette}. Pro uchování dat byla použita databáze MySQL~\cite{mysql}.

\subsection{Nette Framework}
Nette Framework je aplikační framework, který usnadňuje řešení mnoho problémů v oblasti webového vývoje v PHP. Implementuje návrhový vzor \nomExpl{MVP}{Model-View-Presenter} rozdělující aplikaci na logické vrstvy (viz níže). Běh aplikace je řízen událostmi, tedy využívá událostmi řízené programování. Dále obsahuje komponentový model zaměřený na znovupoužitelnost.

\subsection{MVP}
Návrhový vzor Model-View-Presenter řeší problém oddělení datové vrstvy, řízení událostí (např. od uživatele) a vykreslení daných dat~\cite{mvp}. Následuje popis jednotlivých vrstev a jejich společné interakce.

\begin{itemize}
	\item Model - poskytuje rozhraní pro data určená k zobrazení
	\item View (pohled) - vykresluje data modelu a směruje uživatelské příkazy presenteru
	\item Presenter - prostředník mezi modelem a pohledem. Získává data z modelu a upravuje je pro zobrazení v pohledu. Řeší události vyvolané uživatelem.
\end{itemize}

\subsection{Architektura aplikační logiky}
Nette Framework ovšem neposkytuje žádné vlastní řešení modelové vrstvy a nechává tak programátorovi volné ruce na využití jiných knihoven nebo vlastních řešení zaměřujících se na obchodní a datovou logiku. Do presenteru je pak možné tyto služby předat pomocí návrhového vzoru Dependency injection~\cite{di}.

Pro tento projekt byla využita databázová vrstva Nette\textbackslash{}Database, která poskytuje jednoduché rozhraní pro získávání dat z databáze. Komunikace s databází pak byla zabalena do repositářů, jenž poskytují metody pro navrácení jednotlivých entit a tvorbu a mazání záznamů. V případech, kdy je logika složitější a repositáře tuto funkčnost nemohou vykonat, je přidána další vrstva, fasáda. 

Lepší představu o průběhu chodu aplikace při uživatelském požadavku získáte z obrázku~\ref{fig:logika}. Všechny komponenty serverové části pak přehledně zobrazuje diagram balíčků~\ref{fig:balicky}.


\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/logika.png}
		\caption{Ukázka průchodu aplikace}
		\label{fig:logika}
	\end{center}
\end{figure}

\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/balicky.png}
		\caption{Diagram balíčků}
		\label{fig:balicky}
	\end{center}
\end{figure}


\section{Klientská část}
Na klientské prostředí jsou přenášeny výstupy v podobě HTML stránek. Pro jejich oživení a zlepšení uživatelské použitelnosti (např. klientské validace formulářů) se používá JavaScript. Vlastní kód byl však napsán v CoffeeScriptu~\cite{coffee}, transkompilátoru, který se kompiluje do běžného JavaScriptu. 

Dále byla použita JavaScriptová knihovna jQuery~\cite{jQuery}, která usnadňuje práci s HTML dokumentem a sjednocuje implementační rozdíly mezi prohlížeči.

Pro vzhled a grafické uživatelské rozhraní byl použit framework Bootstrap~\cite{bootstrap}, který velmi usnadnil prototypování uživatelského rozhraní portálu bez nutnosti tvořit vzhled a ladit ho pro každý prohlížeč zvlášť. Dále poskytuje jednoduché metody pro tvorbu nabídek či zobrazení dialogových oken. Výhodou je i to, že Bootstrap poskytuje responsivní design a tak by se měl web chovat a zobrazovat dobře i na mobilních zařízeních.


\section{Editor}
Editoru prezentací byl přikládán větší význam, neboť bez této komponenty by systém nemohl realizovat myšlenku tohoto projektu. Značně se také liší od ostatních obyčejných webových stránek, jelikož se jedná z větší části o ryze klientskou jednostránkovou miniaplikaci.

Právě proto používá editor pár technologií navíc. Jako nejdůležitější se ukázalo použití JavaScriptového \nom{MVC}{Model-View-Controller} frameworku AngularJS~\cite{angular}. Jeho hlavní předností je dvoucestné provázání dat mezi pohledem (view) a modelem na straně klienta. Každá změna v~modelu se pak automaticky propaguje do pohledu a naopak. Snižuje se tak množství kódu, který otrocky nastavuje nebo zobrazuje data při jednotlivé změně. 

Pro popis obsahu snímku, jak bylo zmíněno v analýze, byl se používá jednoduchý textový značkovací jazyk, který převádí text do HTML. Pro převod tohoto textu je použita PHP knihovna Texy!~\cite{texy}, která implementuje vlastní stejnojmenný značkovací jazyk. Výhodou této knihovny je snadná rozšiřitelnost a také typografické úpravy výsledného textu. Více o výběru knihovny se dozvíte v~následující kapitole.

Součástí editoru je také panel nástrojů, který doplňuje textový vstup pro popis snímku. Uživateli ulehčí práci s psaním zdrojového~textu, například možností vložit značky pro tučné písmo či kurzívu atd. Pro panel nástrojů byla použita knihovna Texyla~\cite{texyla}.



\chapter{Realizace klientské části} \label{chap:realizace}
V této kapitole se dozvíte o průběhu realizace klientské části aplikace, tj. editoru prezentací a zobrazení prezentací, co vedlo k rozhodnutím o podobě projektu a jaké problémy vyvstaly a jak byly řešeny.

\section{Prototyp editoru prezentací}
V~první fázi vývoje jsem se zabýval myšlenkou editoru prezentace jako hlavní komponenty, bez které by projekt neplnil požadovanou funkci. Následující text popisuje průběh práce na prototypu editoru prezentace.

\subsection{WYSIWYG editor}
Při prvním prototypování editoru snímků prezentace se počítalo s~použitím WYSIWYG editoru, tedy editoru, kde jsou změny vidět v reálném čase a uživatel při samotné úpravě snímků okamžitě vidí, jak bude vypadat konečný výsledek. Výhodou je, že uživatel nepotřebuje znát ani jazyk HTML (i když knihovny často poskytují i možnost kód HTML upravovat). Existuje mnoho knihoven, které WYSIWYG editor různě implementují. Protože ale neexistuje žádný standard, každý prohlížeč se chová trochu jinak a zároveň každá knihovna si různé věci implementuje po svém.

Nejdříve byla otestována WYSIWYG knihovna Aloha Editor~\cite{aloha}, která se nejčastěji používá v \nom{CMS}{Content Management System} systémech. Nabízí několik zajímavých vlastností jako je např. repositář - prohlížeč obrázků, souborů či vlastních uživatelských objektů. Potíže ovšem nastaly se zobrazením panelu nástrojů a špatnou podporou CSS3 transformací, které jsou použity ve vzhledu deck.js prezentací.

Jako další editor byl vyzkoušen Mercury Editor~\cite{mercury}, který se zdál být vhodnější a komplexnější. I když se jedná o JavaScriptovou knihovnu, je vyvíjena v~Ruby pro použití v~Ruby On Rails aplikacích a tak bylo hodně věcí přizpůsobeno těmto technologiím (například počítala s~partial pohledy, které se posílají pomocí technologie \nom{AJAX}{Asynchronous JavaScript and XML} ze serveru). Nicméně knihovna není na jazyce Ruby závislá a lze ji použít bez něj.

Zde se ale po chvíli objevily problémy technického rázu – prohlížeče se právě díky neexistujícímu standardu chovaly rozdílně nebo se nechovaly podle očekávání. Výsledkem pak byl například špatný HTML kód nebo kód, který se už nedal nijak pomocí editoru opravit ani smazat. Jedním z~největších problémů bylo vkládání nového řádku. Prohlížeč někdy vložil značku odřádkování \verb|<br>| někdy nový odstavec \verb|<p>|. Chování tak nebylo předvídatelné. 

Objevily se i další chyby v~použitelnosti či bugy, na které jsem se pak snažil upozornit\footnote{viz \url{https://github.com/jejacks0n/mercury/issues/253}} autora knihovny. Chyba ale dosud nebyla opravena.

\subsection{Editor založený na jednoduchém značkovacím jazyce}
Všechny tyto problémy nakonec vyústily k rozhodnutí použít značkovací jazyk, tzv. Lightweight markup language, který
převádí text do HTML. V~poslední době získávají tyto jazyky velkou popularitu kvůli jednoduchosti a velmi dobré podobě
výsledného HTML kódu.

Asi nejvíce používaným jazykem, hlavně ve světě IT, je Markdown~\cite{markdown}, který byl původně napsán v jazyce Perl. Vzniklo mnoho portů této knihovny do různých jazyků, včetně PHP. Port knihovny pro PHP je ovšem velmi komplexní a zdálo se nemožné ho upravit pro potřeby implementace dalších požadovaných funkcí do prezentace.

Proto nakonec bylo rozhodnuto využít jazyk Texy!~\cite{texy}, který je jazyku Markdown podobný, ovšem syntaxe se občas liší. Knihovna Texy! je ovšem velmi dobře rozdělená na logické jednotky - moduly. Jednotlivé konverze (např. nadpis nebo tučné písmo) se pak provádí ve funkcích těchto modulů. Za největší výhodu ale považuji rozšiřitelnost a upravitelnost knihovny. Moduly lze konfigurovat či vypínat a nechybí ani možnost definovat vlastní konverze. Lze se tak snadněji přiblížit syntaxi jazyku Markdown, primárním cílem toto ovšem nebylo.

Výhodou je také možnost specifikovat CSS třídy nebo určit zarovnání textu či obrázku. To je vlastnost, kterou jazyk Markdown nepodporuje. Značným kladem knihovny Texy! je také vynikající podpora typografie. Například sekvenci znaků „\lstinline|+-|“ nahradí za jediný znak „$\pm$“, jednoduchou pomlčku nahrazuje za spojovník (pokud je to ve větě potřeba), tři tečky nahradí za jediný znak trojtečky, vkládá nedělitelné mezery za spojky atp. V dokumentech jako je webová stránka nebo prezentace se tato vlastnost velmi hodí.


\section{Rozložení editoru}
Dalším úkolem bylo navrhnout prostředí editoru. Rozložení bylo provedeno v podobném stylu jako u známých nástrojů pro tvorbu prezentací Microsoft PowerPoint a OpenOffice Impress, tedy obrazovka byla rozdělena na sloupec náhledů všech snímků po levé straně obrazovky a na editaci právě upravovaného snímku vpravo.

Protože se ale pro popis obsahu snímku používá značkovací jazyk namísto WYSIWYG editoru, bylo uživatelsky příjemnější přidat také náhled výsledného snímku po převodu zdrojového textu do HTML. Tímto se obrazovka rozdělila ještě na vstupní textové pole pro zdrojový text a velký náhled právě upravovaného snímku. Textové pole má navíc panel nástrojů, který umožňuje vkládat značky (například nadpis, nebo kurzívu) pomocí tlačítek.

\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/editor2.png}
		\caption[Ukázka editoru]{Ukázka editoru (vlevo náhledy všech snímků, uprostřed pole zdrojového textu, vpravo velký náhled upravovaného snímku)}
		\label{fig:editorLayout}
	\end{center}
\end{figure}


\section{Chování editoru}
V následujícím textu je popsáno, jak editor prezentace funguje.

Při načtení stránky editoru se obsah prezentace převede na JavaScriptový objekt, který uchovává informace o jednotlivých snímcích. Součástí těchto dat je zdrojový text obsahu snímku a také jeho HTML podoba po konverzi. HTML kód každého snímku se pak vloží do panelu s~malými náhledy. Malý náhled snímku je pomocí CSS pravidel zmenšen, jinak by obsah byl stejně velký jako v~normálním zobrazení prezentace.

Po kliknutí na malý náhled se objeví v~textovém poli pro úpravu snímku zdrojový text snímku a ve velkém náhledu vpravo se objeví kompletní snímek s~inicializovanou knihovnou deck.js, tj. včetně funkční interakce.

Při změně zdrojového textu snímku se celý obsah automaticky posílá na server, kde se text pomocí knihovny Texy! převádí na HTML kód. Výsledný HTML kód snímku se následně vrací v odpovědi. Poté se aktualizují oba náhledy snímku, malý i velký. Aby se ale na server neposílala každá úprava snímku (např. po stisku každého písmene), a tak nevhodně zatěžovala server i klientskou aplikaci, byla implementovaná čekací doba 1 sekundy. Pokud po poslední změně snímku uplyne tato doba, během které nebyla provedena žádná další úprava, pošle se požadavek na převod zdrojového textu na server.


\section{Úprava knihovny Texy!}
Následující odstavce popisují rozšíření jednoduchého značkovacího jazyka Texy!. Bylo totiž nutné vymyslet a implementovat novou syntaxi pro interaktivní odpovídání na kvizové otázky během prezentace a další novinky. Dále jsem se pokusil upravit syntaxi značkovacího jazyka Texy! pro lepší kompatibilitu s více rozšířeným a známým jazykem Markdown.

\subsection{Markdown syntaxe}
Jak už bylo vysvětleno v předchozích kapitolách, pro popis snímků byla použita knihovna Texy!, která implementuje vlastní jazyk stejného jména. Tento jazyk je ovšem široce používaný pouze v českých a slovenských zemích. Celosvětově ho zastiňuje mnohem více rozšířený značkovací jazyk Markdown. Oba jazyky jsou si v lecčem podobné, avšak najdou se i velké rozdíly. Proto jsem se rozhodl knihovnu Texy! upravit a některé části přizpůsobit syntaxi jazyku Markdown.

Jeden z~nejvíce patrných rozdílů byl v~syntaxi nadpisů. Porovnejte rozdíly mezi výpisy \ref{lst:nadpisy1} a \ref{lst:nadpisy2}.

\begin{lstlisting}[caption=Ukázka nadpisů v Texy!,label={lst:nadpisy1}]
### Nadpis 1. úrovně
## Nadpis 2. úrovně
# Nadpis 3. úrovně

nebo alternativně

Nadpis 1. úrovně
################

Nadpis 2. úrovně
****************

Nadpis 3. úrovně
================
\end{lstlisting}

\begin{lstlisting}[caption=Ukázka nadpisů v Markdown,label={lst:nadpisy2}]
# Nadpis 1. úrovně
## Nadpis 2. úrovně
### Nadpis 3. úrovně

nebo alternativně

Nadpis 1. úrovně
================

Nadpis 2. úrovně
----------------
\end{lstlisting}

Jak je vidět, logika syntaxí značek u varianty před nadpisem je u obou jazyků přesně opačná. Proto byla syntaxe upravena, aby byla ekvivalentní s jazykem Markdown. Změna pak byla otestována pomocí jednotkových testů.

Protože ale sjednocení syntaxí nebylo prioritou tohoto projektu, nezaměřoval jsem se více na další zvýšení kompatibility.


\subsection{Nová syntaxe}
Dále bylo nutné rozšířit knihovnu Texy! a implementovat vlastní pravidla konverze textu do HTML. Rozšíření se týkalo možnosti uživatele odpovídat na otázky během prohlížení prezentace a dále vytvoření osnovy prezentace s odkazy na snímky.

\subsubsection{Syntaxe odpovědí}
Pro vytvoření kvizových otázek bylo potřeba vymyslet a implementovat syntaxi na vložení zaškrtávacího pole, které uživatel při prohlížení prezentace může zaškrtnout jako správnou odpověď na otázku položenou na snímku. Správných odpovědí může být více. Po delší úvaze bylo rozhodnuto, že na jednom snímku lze mít pouze jednu otázku. Nejenže by se více otázek na snímek nevešlo, ale zjednodušila se tak i složitost syntaxe, která by na tento případ musela brát ohled. Stejně tak odpadla potřeba manuálně vkládat potvrzovací tlačítko pro kontrolu zaškrtnutých odpovědí. Tlačítko se při překladu vkládá na konec snímku automaticky, pokud je na snímku použita syntaxe pro vložení zaškrtávacích políček. Ukázku syntaxe můžete vidět ve výpisu \ref{lst:odpovedi} a snímek po převodu do HTML na obrázku \ref{fig:odpovedi}.

\begin{lstlisting}[caption={Ukázka zdrojového textu snímku s otázkou a odpovědmi},label={lst:odpovedi}]
## Otázka č. 1

Co je cílem scopingu?

[+] získat požadavky od zákazníka

[-] vytvořit rozpočet a plán projektu
\end{lstlisting}


\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/odpovedi.png}
		\caption{Ukázka snímku s otázkou a odpovědmi}
		\label{fig:odpovedi}
	\end{center}
\end{figure}

Pro vyhodnocení správnosti zaškrtnutých odpovědí musí uživatel stisknout tlačítko pro kontrolu. Případné chybné odpovědi mají za následek přiřazení CSS třídy ke špatně zaškrtnutým políčkům.

Samotná zaškrtávací políčka nejsou zobrazena jako HTML vstupní pole \verb|<input>| proto, aby se daly lépe vzhledově upravit pomocí CSS stylů.

\subsubsection{Syntaxe doplňkových textů}
Důležitou součástí požadovaného kvizového systému byla také možnost vkládat doplňkový text. Autor prezentace tak může uvést bližší informace k~odpovědím na danou otázku nebo odkázat na jiný snímek prezentace či dokonce na jiný web.

Tento text se rozděluje na dva typy: pro správně a nesprávně zaškrtnuté odpovědi. Tento doplňkový text se dynamicky objeví až po kliknutí na potvrzovací tlačítko, přitom text pro správně zaškrtnuté odpovědi se zobrazí při zaškrtnutí pouze správných odpovědí, u textu pro špatné odpovědi přesně naopak.

Pro vložení takového bloku textu byla použita podobná syntaxe jako pro ostatní účelové bloky textu v~syntaxi Texy!
(např. blok kódu). Použití syntaxe pro oba doplňkové texty vidíte ve výpisu \ref{lst:texts}

\begin{lstlisting}[caption={Syntaxe doplňkových textů},label={lst:texts}]
/--correct
Tento text se zobrazí při **správné** odpovědi.
\--

/--incorrect
Tento text se zobrazí při **špatné** odpovědi.
\--
\end{lstlisting}

\subsubsection{Syntaxe pro vložení osnovy}
V mnoha prezentacích se můžeme setkat s více tématy nebo podtématy, o kterých prezentace pojednává. Proto editor prezentace poskytuje možnost rozdělit prezentaci na logické celky. U každého snímku tak lze specifikovat až tři úrovně sekcí, do kterých snímek logicky patří. Toho pak bylo využito pro další vlastnost převodu zdrojového textu do HTML - generování osnovy (obsahu) prezentace s odkazy na snímky, které tyto sekce specifikují. Syntaxe je pak jednoduchá, stačí uvést \verb|{table of contents}|. Při převodu je pak tato direktiva nahrazena HTML seznamem sekcí a případných podsekcí s odkazy vedoucími na dané snímky.


\section{Rozšíření prezentační knihovny}
Protože tento nástroj byl zaměřen na použití ve vzdělávacích institucích, bylo dobrou myšlenkou rozšířit možnosti prezentační knihovny o další pomocné funkce. Rozhodl jsem se proto implementovat funkci zvýraznění syntaxe bloků programovacích jazyků, která se určitě bude hodit prezentujícím vývojářům, a dále zobrazení matematických vzorců ve formátu \LaTeX, které bude možné použít například v prezentacích z oboru matematiky.

\subsection{Zvýraznění syntaxe programovacích jazyků}
Pro zobrazení kódu používá knihovna Texy! blokovou syntaxi jakou můžete vidět ve výpisu \ref{lst:code}. Po převodu tohoto textu do HTML se uvedený kus kódu obalí do sebe vnořených sémantických HTML značek \verb|<pre>| a \verb|<code>|. Toho je pak využito při zvýraznění syntaxe, jež je zajištěno pomocí knihovny highlight.js~\cite{highlight}, která automaticky tyto bloky kódu za použití detekce jazyka zvýrazní. Knihovna podporuje více než 50 jazyků.

\begin{lstlisting}[caption={Ukázka blokové syntaxe pro výpis kódu},label={lst:code}]
/--code
SELECT * FROM `presentations` where `id` = 1;
\--
\end{lstlisting}


\subsection{Matematické vzorce}
Další přidanou hodnotou do prohlížení prezentací bylo zavedení zobrazení matematických vzorců a rovnic. Není totiž nijak uživatelsky příjemné tyto vzorce vytvářet jako obrázky a vkládat je pak do prezentace. Pro implementaci této vlastnosti byla použita JavaScriptová knihovna MathJax~\cite{mathjax}, která automaticky vyhledává zdrojový text ve formátu \LaTeX~\cite{latex} ve specifické syntaxi a následně je vysází pomocí HTML a CSS za použití webových fontů. Není tedy potřeba žádných dalších technologií třetích stran, jako například Flash, a zároveň se nejedná o obrázky, zachovává si tak všechny vlastnosti okolního textu, jako barva či velikost.

Podmínkou pro vyhledání a zobrazení vzorců je ohraničení zdrojového textu vzorců oddělovači. Ty jsou dvojího druhu, protože knihovna podporuje zobrazení jak blokových vzorců, tak tzv. inline vzorců, ty mohou být součástí odstavců textu. Oddělovače pro inline vzorce jsou \verb|$(| a \verb|)$|, pro blokové vzorce pak \verb|$$| a \verb|$$|. Ukázku použití této syntaxe spolu se vzorovým zdrojovým textem několika rovnic vidíte ve výpisu \ref{lst:rovnice}, výsledný snímek s vysázenými matematickými rovnicemi vidíte na obrázku \ref{fig:rovnice}.

\begin{lstlisting}[caption={Ukázka syntaxe matematických vzorců},label={lst:rovnice}]
## Rovnice

$$
\begin{aligned}
\dot{x} & = \sigma(y-x) \\
\dot{y} & = \rho x - y - xz \\
\dot{z} & = -\beta z + xy
\end{aligned}
$$
\end{lstlisting}

\begin{figure}[ht]
	\begin{center}
		\includegraphics[width=14cm]{PRO-img/rovnice.png}
		\caption{Ukázka snímku s matematickými rovnicemi}
		\label{fig:rovnice}
	\end{center}
\end{figure}



\chapter{Testování}
Testování je důležitou součástí vývoje každého softwarového systému. Jedná se o takové zkoušení systému, které nalezne nejen chyby (tzv. bugy) v softwaru, ale ověřuje také, zda-li vyhovuje zadaným požadavkům. Před několika lety, často se s tím ale můžeme setkat i dnes, se testování provádělo ručně. Zvláště v jazyku PHP se často při každé změně ručně obnovuje stránka v prohlížeči a následně se kontrolují výstupy.

V současné době se ale software nejčastěji testuje s pomocí automatických nástrojů. To znamená, že testy definované nějakým scénářem jsou spouštěny všechny najednou a výsledkem jsou zprávy, zda všechny testy úspěšně prošly. Pokud některé testy neprošly, snadno zjistíme příčinu. Při každé změně software tak můžeme rychle zjistit, zda-li systém vyhovuje požadavkům a zda neobsahuje chyby. Protože máme možnost spouštět všechny testy, můžeme mít (větší) jistotu, že změna nerozbila jiné části systému, které na první pohled se změnou nesouvisí.


\section{Test Driven Development}
\nomExpl{TDD}{Test Driven Development}~\cite{tdd} neboli vývoj řízený testy je metodika vývoje software, kdy se test píše dříve než kód, který má daný test ověřit. Použití této metodiky má několik výhod - test je psán bez znalosti vnitřní implementace ověřovaného kódu a je tak pro programátora těžší být ovlivněn vlastní implementací. Vedlejším efektem je pak i lepší návrh aplikace. Protože v testech se snažíme psát co nejméně kódu, programátor se pak snaží testovaný kód mít co nejjednodušší pro nastavení a inicializaci, což prospívá i jednoduchosti samotné implementace.

Tento projekt je prvním, kdy jsem se snažil používat metodiku TDD. Ne vždy se to však povedlo, neboť jsem byl zvyklý na opačný postup. Nejvíce jsem jej využil při úpravě a implementaci nových syntaxí v knihovně Texy!, kdy jsem si pro požadované výstupy knihovny napsal test předem a poté dané změny syntaxe implementoval. Dále pak bylo TDD použito při refaktorování backendu aplikace.

Metodika TDD se velmi dobře aplikuje a při vývoji mi pomáhala, avšak zvyklost byla často silnější. V dalších projektech se budu snažit používat ji ještě více.


\section{Jednotkové testy}
Jednotkové nebo také unit testy jsou testy, které ověřují správnost jedné malé části software, tzv. jednotky. Typicky jsou to metody nebo třídy. Jejich úkolem je zjistit správnost funkčnosti této jednotky nehledě na vlivy ostatních jednotek, např. ostatních tříd či metod nebo úplně jiných systémů.

V tomto projektu byly unit testy psány hlavně při úpravě syntaxe knihovny Texy!. Bylo nutné, aby nové prvky syntaxe nebyly v konfliktu s již existujícími, což však bylo znemožněno neexistujícími testy v samotné knihovně Texy!. Testy tak sloužili jen na ověření výstupu nové či upravené syntaxe.

Protože jsou výstupy testů syntaxe často dlouhé a ve zdrojovém souboru by byly nepřehledné, byly jak vstupy tak očekávané výstupy jednotlivých testů přesunuty do textových souborů. Vstupní soubory se pak dávkově nahrávaly do testu a výstup se kontroloval oproti souborům s očekávanými výstupy.

Unit testy byly napsány s pomocí PHP frameworku pro jednotkové testování PHPUnit~\cite{phpunit}.


\section{Integrační testy}
Integrační testy ověřují komunikaci mezi více jednotkami, testovaný kód je oproti jednotkovým testům již závislý i na ostatních třídách, komponentách, systémech nebo dokonce platformě či hardwaru.

Tímto způsobem byla v projektu testovaná modelová vrstva aplikace, tedy entity, repositáře a fasády. Testované třídy používají funkční MySQL databázi, která obsahuje testovací data. Při každém jednotlivém testu se databáze smaže a vytvoří znovu podle SQL souboru obsahující definice tabulek a data ve výchozím stavu. Je tak vyřešena jakákoliv nekonzistence mezi jednotlivými testy a není potřeba po každém testu ručně navracet databázi do výchozího stavu. Stejně jako u jednotkových testů byl použit framework PHPUnit. Ukázky integračních testů naleznete ve výpisu \ref{lst:integrationtest} v příloze \ref{chap:ukazkykodu}.

\begin{table}[H]
    \center \begin{tabular}{ll}
    Počet testů           & 57  \\
    Počet úspěšných testů & 57  \\
    Pokrytí kódu          & 52 \%  \\
    \end{tabular}
\end{table}


\section{Selenium testy}
Pro testování uživatelského rozhraní byl použit systém Selenium~\cite{selenium}. Jeho hlavním úkolem je automatizace webových prohlížečů, nejčastěji se ale používá právě jako testovací nástroj. 

Selenium poskytuje rozhraní pro komunikaci s různými prohlížeči různých verzí. Testy se skládají ze scénářů, tedy předem definovaných kroků prohlížeče (např. kliknutí na odkaz nebo vyplnění formulářového pole) a díky komunikačnímu rozhraní lze také z prohlížeče získávat informace (např. zda-li se na stránce objevuje nějaké slovní spojení). Tyto scénáře můžou být interaktivně vytvořeny pomocí Selenium IDE (pouze pro prohlížeč Firefox) a pak je lze opakovaně spouštět. Další možností je použít Selenium Remote Control (RC), který dokáže prohlížeč spustit a vykonat scénáře definované v nějakém z podporovaných programovacích jazyků.

Ovladač pro Remote Control jazyk PHP podporuje a zmíněný testovací framework PHPUnit poskytuje rozšíření implementující klient-server protokol pro komunikaci s RC. Navíc také nabízí specializované metody pro testování. Ve výpisu \ref{lst:seleniumtest} v příloze \ref{chap:ukazkykodu} se můžete podívat, jak takový test vypadá.

\section{Zátěžové testy}
Zátěžové testy prověřují chování aplikace pod narůstajícím počtem požadavků. Je tak snadné zjistit, zda-li je aplikace dostatečně rychlá a zda-li ustojí větší počet aktivních uživatelů. Pro otestování tohoto projektu nasazeném na AppFog jsem se rozhodl využít webový nástroj Load Impact~\cite{loadimpact}, jenž zdarma poskytuje zátěžové testy s maximálně 50 souběžnými virtuálními uživateli. 

Zdarma ale služba nenabízí výběr místa odkud požadavky přicházejí. To se pak podepsalo na delší odezvě serveru, neboť požadavky většinou nepřicházely z Evropy, kde se aplikační server nachází. Zvyšující se zátěž ale nepředstavovala pro aplikaci větší problém a i při plném vytížení, jenž LoadImpact poskytuje, byla doba načtení konstantní.

Pro testování byly vybrány dvě stránky, které představují pro aplikaci velkou režii a to jak na straně PHP tak i na straně databáze. Občas se vyskytly mírné fluktuace, které jsou nejspíš vinou bezplatné aplikace AppFogu\footnote{Je obecně známo, že služba AppFog neposkytuje dostatek zdrojů ani kvality pro bezplatné účty.}, neboť u následujícího vyššího zatížení se tyto výkyvy neprojevily. Grafy výsledků obou testů najdete v příloze \ref{chap:loadtest}.

\chapter{Nasazení}
V této kapitole jsou shrnuty požadavky na nasazení aplikace a dále je vylíčen průběh nasazení projektu na produkční server.

\section{Požadavky}
Pro chod systému je nutný spuštěný webový server, na kterém běží PHP. Dále je pak potřeba MySQL databáze. Komponenty a jejich verze, na kterých byl projekt vyvíjen, jsou uvedeny níže.

\begin{itemize}
	\item Apache 2.2
	\item PHP 5.3
	\item MySQL 5.5
\end{itemize}

Pro zaručení správného chodu aplikace je také dobré ověřit, zda-li server splňuje požadavky samotného Nette Frameworku. K tomu lze využít PHP skript jménem Requirements Checker, jenž je frameworkem poskytován. Více o skriptu, jeho instalaci a spuštění naleznete v dokumentaci Nette Frameworku~\cite{checker}.

\section{Realizace nasazení}
Pro nasazení na produkční prostředí jsem se nejdříve rozhodl využít cloudového systému PHP Fog. Pro malý počet aplikací a malý rozsah poskytoval své služby zdarma. V placených řešení bylo pak největší výhodou možnost škálování instancí aplikace či operační paměti nebo velké množství rozšíření, např. analytické nástroje či optimalizační nástroje pro databázi. Server uchovával aplikaci jako Git repositář a tak pro nahrání nové verze aplikace stačil příkaz \verb|push|.

V listopadu 2012 bylo ovšem oznámeno ukončení služby PHP Fog a postupné odpojování bezplatných aplikací v průběhu prosince 2012. Jako náhrada byla doporučena podobná služba AppFog~\cite{appfog} od stejné firmy~\cite{phpfogdiscont}.

AppFog, podobně jako PHP Fog, je cloudová služba poskytující \nomExpl{PaaS}{Platform as a Service}, tedy výpočetní platformu a k tomu funkční řešení operačního systému, webového serveru, databáze a dalších. Aplikaci tak stačí pouze nasadit a spustit. AppFog na rozdíl od PHP Fogu podporuje kromě jazyka PHP i další, např. Node, Ruby či Javu. Změněn byl i způsob nahrávání aplikace, z Git repositáře se přešlo na vlastní konzolový nástroj, který dále nabízí i komplexní správu nasazených aplikací.

Nevýhodou této služby je v současné době neexistující persistentní úložiště souborů, to znamená, že každá změna provedená na souborech na serveru, např. uložení obrázků nahraných uživateli aplikace, bude při nahrání nové verze aplikace nenávratně ztracena (databází se to ovšem netýká). Tento problém měl být vyřešen ve stejné době jako ukončení provozu PHP Fogu, avšak ani v době dokončování psaní této práce nebyla situace vyřešena. Pro vložení obrázků do prezentací si tak uživatelé prozatím musí vystačit s jinými službami pro sdílení obrázků. Samotný editor ale nabízí vložení souborů ze služby Dropbox pomocí prohlížeče Dropbox Chooser~\cite{dropboxchooser}.

\section{Deployment}
Projekt byl průběžně vyvíjen na lokálním serveru a při větším počtu změn byl aktualizován produkční server. Pro řešení závislostí použitých PHP knihoven jsem přidal balíčkovací systém Composer, který kromě závislostí obstará i stažení a aktualizaci těchto knihoven. Knihovny tak nejsou součástí projektu a při nasazení je potřeba je příkazem \verb|install| do aplikace stáhnout a nainstalovat. Více se dočtete v dokumentaci Composeru~\cite{composer}.

Další významnou součástí aktualizace systému byla migrace databáze při její změně. K tomu byla použita knihovna Phinx, kterou jsem upravil, aby používala konfigurační soubor Nette Frameworku. Při změně schématu databáze je pak nutné příkazem vytvořit PHP soubor ve složce \verb|migrate|, který obsahuje metodu pro provedení změny v databázi a také metodu pro navrácení do původního stavu. Při aktualizaci projektu je pak nutné provést příkaz \verb|migrate|, který dosud neprovedené změny databáze provede. Více informací získáte z dokumentace knihovny Phinx~\cite{phinx}.


\chapter{Zhodnocení a budoucí vývoj}
Práce na tomto projektu byla velmi zajímavá. Vyzkoušel jsem si řadu nových technologií, zejména AngularJS, který určitě budu dál sledovat a snad i s~ním znovu někdy pracovat. Kromě AngularJS jsem si poprvé vyzkoušel i migrace databází v PHP a i když to není tak automatické jako třeba v Ruby on Rails, pracuje se s knihovnou velmi dobře.

Výbornou zkušeností bylo také nasazení projektu na cloudové PaaS systémy. Tyto služby jsou nejen jednoduché na použití, ale poskytují široké možnosti správy a škálování aplikací. Platforma PHP ovšem trochu kulhá při větším počtu instancí a je proto nutné s řešením počítat již při vývoji aplikace. Placená řešení cloudových systémů ovšem mnohanásobně převyšují výhody vlastního serveru nebo běžných webhostingových služeb.

S projektem jsem celkově spokojený, i když jsem zprvu čekal mnohem rychlejší vývoj, některé doplňkové funkce, tzv. nice-to-have, tak kvůli nedostatku času či kvůli řešení jiných problémů nebyly implementovány. Problémy nastaly u prezentační knihovny a vzhledu prezentace, které zpomalovaly vývoj. Dále by bylo dobré zapracovat na zlepšení uživatelské přívětivosti a mobilní verzi.

Z práce na projektu jsem ale zjistil, že se v době responzivních designů a dalších novinek v CSS3 začínám ztrácet a řešení vzhledu webů a \nomExpl{UX}{User experience} nestíhám sledovat. Proto bych se v dalších projektech více zaměřil na vývoji back-endu aplikací a přenechal tyto problémy zkušenějším webovým designerům.

Jsem rád, že jsem použil Nette Framework, který dobře znám a tak jsem neměl tolik problémů při vývoji serverové části. Ze začátku jsem se ovšem rozhodoval, jestli si nevyzkoušet nějakou jinou technologii, například dnes populární Ruby on Rails nebo Node.js. Při výběru jsem bral v úvahu hlavně malé zkušenosti s těmito technologiemi a bál jsem se možných problémů a mnohem pomalejšího vývoje při jejich řešení. Na druhou stranu jsem se ochudil o možnost si technologie vyzkoušet a zjistit pro a proti. Při práci na tomto projektu jsem ale zjistil, že PHP má jednu nevýhodu a to v nedokonalém ekosystému, naproti tomu Ruby on Rails dokáže pár příkazy stáhnout, nainstalovat a nakonfigurovat potřebné knihovny.

\section{Budoucí vývoj}
Projekt je sice v použitelném stavu, ale rozhodně není dokonalý a chybí jisté funkce či vylepšení, které by uživatelé ocenili. Následující odstavce popisují nejdůležitější body mojí vize dalšího vývoje projektu. Nejedná se pouze o zlepšení UX při prohlížení prezentací, ale také nové funkce, které zlepší organizaci, přehlednost a zpětnou vazbu uživateli.

\subsection{Náhledy prezentací}
V současné chvíli jsou prezentace ve výpisech na webu reprezentovány pouze názvem prezentace. Chybí tak jakákoliv grafická vazba na prezentaci. Uživatelé se ale mnohem rychleji orientují podle obrázků než podle textů. Proto by bylo dobré ve výpisech zobrazovat i náhled prvního snímku prezentace.

\subsection{Notifikace}
Jako další vylepšení by mohly sloužit notifikace (upozornění) uživatelům, ať už prostřednictvím webu nebo posíláním e-mailů. Nyní se o nových prezentací sledovaných uživatelů nebo nasdílení prezentace uživatel nedozví. Vidí je pouze ve výpisech na hlavní stránce webu, vizuálně ale uživatel není nijak upozorněn.

\subsection{Import a export prezentací}
Pro uživatele by bylo výhodné přidat i podporu pro import a export z/do různých formátů. Import uživateli ušetří čas při sdílení existujících prezentací v jiných formátech. Export pak lze využít pro prohlížení prezentací bez připojení k internetu.

Při práci na tomto projektu jsem pokusil o import z formátu Microsoft PowerPoint. Jednalo se ovšem jen o účelový nástroj pro několik prezentací, značně přizpůsobený jednomu typu prezentace. Importován byl pouze text každého snímku, tj. bez vzhledu či obrázků.

\subsection{Členění a seskupování prezentací}
Prezentace se nyní dají vyhledávat jen pomocí názvu nebo podle autora. Další možností by bylo přidat k prezentacím štítky. Vyhledávání by pak mohlo fungovat i podle štítků. Také sdílení by šlo vylepšit tím, že by uživatel mohl sledovat jednotlivé štítky a být upozorněn v případě nové prezentace s daným štítkem.

Prezentace by si také zasloužily lepší organizaci. Často se stává, že jeden uživatel má více prezentací, které spolu souvisí (například prezentace z přednášek jednoho předmětu nebo kurzu). Strukturování prezentací do jakých si složek nebo seznamů by tak bylo užitečnou vlastností.

\subsection{Bezpečnost}
Důležitou částí dalšího vývoje by mělo být zaměření na bezpečnost systému. V tuto chvíli mi dělá starost existující možnost zanesení škodlivého JavaScriptového kódu do prezentace při úpravě vzhledu prezentace. V některých prohlížečích lze totiž v CSS spouštět JavaScriptový kód. Řešením by bylo CSS kód automaticky projít a všechny výskyty JavaScriptu odstranit. Není to ale tak jednoduché, například kvůli komentářům či dalším technikám obfuskace kódu.


\chapter{Závěr}
Výsledkem této bakalářské práce je funkční základ webového portálu pro tvorbu a sdílení prezentací založených na technologii HTML. Navržený systém byl nasazen na produkčním serveru\footnote{\url{http://slide-it.eu01.aws.af.cm/}} pomocí cloudové služby AppFog. Požadovaná funkčnost byla analyzována, implementována a otestována, stále je ale prostor pro další vylepšení a rozšiřování systému.

Projektu se ale nevyhnuly určité problémy, ať už technologické či časové. Nedostalo se tak na spousty nápadů, které by systém posunuly kvalitativně dál, aby mohl konkurovat zavedeným portálům. Přese vše jsem ale s projektem a svou prací na něm spokojen. Vyzkoušel jsem si několik nových a zajímavých technologií, které mě obohatily a které nejspíš využiji i v budoucnu.




\bibliographystyle{csplainnat}
{
\def\CS{$\cal C\kern-0.1667em\lower.5ex\hbox{$\cal S$}\kern-0.075em $}
\bibliography{BP-ref}
}




%%%%%%%%%%%%%%%%%%%%%%%%%% 
% vše co následuje bude uvedeno v přílohách
\appendix	

\printnomenclature

\chapter{Ukázky kódu}\label{chap:ukazkykodu}


\begin{lstlisting}[caption={Ukázka integračních testů},label={lst:integrationtest},
language=php,
numbers=left,
breaklines=true]
<?php

class PresentationRepositoryTest extends BaseDbTestCase {

	/** @var PresentationRepository */
	private $repository;

	protected function setUp() {
		parent::setUp();
		$this->repository = new PresentationRepository($this->container->database);
	}

	public function testDeletePresentation() {
		$pres = $this->repository->create(1, 'testFoo', 'testFoo');
		$this->assertNotNull($this->repository->getById($pres->id));

		$this->repository->delete($pres->id, $pres->author->id);

		$this->assertNull($this->repository->getById($pres->id));
	}

	public function testChangeNameAndSlug() {
		$pres1 = $this->repository->getById(1);
		$this->repository->changeNameAndSlug($pres1, 'test foo name', 'test foo slug');

		$pres2 = $this->repository->getById(1);
		$this->assertEquals('test foo name', $pres2->name);
		$this->assertEquals('test-foo-slug', $pres2->slug);

		$this->assertEquals($pres1->name, $pres2->name);
		$this->assertEquals($pres1->slug, $pres2->slug);
	}

	public function testChangeNameAndSlugToExisting() {
		$this->setExpectedException('DuplicateEntryException');

		$pres = $this->repository->getById(1);
		$this->repository->changeNameAndSlug($pres, 'testFooName', 'test2');
	}

}
\end{lstlisting}

\newpage

\begin{lstlisting}[caption={Ukázka Selenium testu},label={lst:seleniumtest},
language=php,
numbers=left,
breaklines=true]
<?php

class SeleniumTest extends PHPUnit_Extensions_SeleniumTestCase {

	public function setUp() {
		parent::setUp();
		$this->setBrowser("*firefox");
		$this->setBrowserUrl($this->url);
	}

	private function loginTest() {
		$this->open($this->url . '/sign/in');

		// bad username
		$this->type("id=frmsignInForm-username", "testerXXXtesterXXXtesterXXXtester");
		$this->type("id=frmsignInForm-password", "test");
		$this->click("id=frmsignInForm-send");
		$this->waitForPageToLoad("10000");
		$this->assertTextPresent("'testerXXXtesterXXXtesterXXXtester'");
		$this->assertTextPresent("not found");

		// bad password
		$this->type("id=frmsignInForm-username", "tester");
		$this->type("id=frmsignInForm-password", "BadBadBadPassword");
		$this->click("id=frmsignInForm-send");
		$this->waitForPageToLoad("10000");
		$this->assertTextPresent("Invalid password");
	}
	
}
\end{lstlisting}

\chapter{Grafy průběhů zátěžových testů}\label{chap:loadtest}

\hvFloat[%
floatPos=htb,%
capVPos=c,%
rotAngle=90,
objectPos=c]{figure}{\includegraphics[width=20cm]{PRO-img/presentation-load.png}}%
[Graf průběh zátěžového testu stránky s prezentací]{Graf průběhu zátěžového testu stránky s prezentací ukazuje dobu načtení stránky (modrá čára), počet aktivních uživatelů (zelená čára) a počet požadavků za sekundu (oranžová čára)}{fig:test1}

\hvFloat[%
floatPos=htb,%
capVPos=c,%
rotAngle=90,
objectPos=c]{figure}{\includegraphics[width=20cm]{PRO-img/user-load.png}}%
[Graf průběhu zátěžového testu stránky s prezentacemi uživatele]{Graf průběh zátěžového testu stránky s prezentacemi uživatele ukazuje dobu načtení stránky (modrá čára), počet aktivních uživatelů (zelená čára) a počet požadavků za sekundu (oranžová čára)}{fig:test2}
	

\chapter{Obsah přiloženého CD}

%\begin{figure}[h]
%\begin{center}
%\includegraphics[width=14cm]{figures/seznamcd}
%\caption{Seznam přiloženého CD --- příklad}
%\label{fig:seznamcd}
%\end{center}
%\end{figure}



\end{document}

















